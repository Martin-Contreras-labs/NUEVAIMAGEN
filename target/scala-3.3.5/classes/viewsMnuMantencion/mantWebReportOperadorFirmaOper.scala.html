@(mapDiccionario: Map[String,String], mapPermiso: Map[String,String], mantTransacReport: tables.MantTransacReport, desdeAAMMDD: String, hastaAAMMDD: String, id_equipo: Long)



@main("") {


	<div id="mostrarmostrar" style="display:none;">

		
		<div class="row  justify-content-md-center">
			<div class="col-xs-12 col-sm-12 col-md-6 col-lg-6">
				<br>
				<form id="grabarFirmaOperador" action="/routes3/mantWebGrabarFirmaOperador/" method="POST" enctype="multipart/form-data">
					<input type="hidden" name="id_mantTransacReport" value="@mantTransacReport.getId()">
					<input type="hidden" name="fechaDesde" value="@desdeAAMMDD">
					<input type="hidden" name="fechaHasta" value="@hastaAAMMDD">
					<input type="hidden" name="id_equipo" value="@id_equipo">

					<table class="table table-sm table-bordered table-condensed table-fluid">
						<thead>
							<tr>
								<td style="text-align:left;"><strong>ID:</strong></td>
						        <td style="text-align:left;" width="70%" colspan="4">
						        	<input style="max-width:150px" type="text" class="form-control"
										value="@mantTransacReport.getId()"
										readonly>
						        </td>
							</tr>
							<tr>
								<td style="text-align:left;"><strong>FECHA:</strong></td>
						        <td style="text-align:left;" width="70%" colspan="3">
						        	<input style="max-width:150px" type="date" class="form-control form-control-sm" 
										value="@mantTransacReport.getFecha()" 
										readonly>
						        </td>
						        <td style="text-align:center;" width="70px">
									@if( ! mantTransacReport.getDocAnexo().equals("0")){
										<a href="#" onclick="descargaDocumento('@mantTransacReport.getDocAnexo()')">
											<kbd style="background-color: #7F8C8D">docum</kbd>
										</a>
									}
								</td>
							</tr>
							<tr>
								<td style="text-align:left;"><strong>USER_MADA:</strong></td>
						        <td style="text-align:left" width="70%" colspan="4">
						        	<input type="text" class="form-control"
										value="@mantTransacReport.getUserNameAdam()"
										readonly>
						        </td>
							</tr>
							<tr>
								<td style="text-align:left;"><strong>PERFIL:</strong></td>
						        <td style="text-align:left" width="70%" colspan="4">
									<input type="text" class="form-control"
										value="@mantTransacReport.getNameActorPersonal()"
										readonly>
						        </td>
							</tr>
							</thead>
					</table>
					<table class="table table-sm table-bordered table-condensed table-fluid">
						<thead>
							<tr>
								<td style="text-align:left;"><strong>OPERADOR:</strong></td>
						        <td style="text-align:left" width="70%" colspan="4">
									<input type="text" class="form-control"
										value="@mantTransacReport.getFullNameOperador()"
										readonly>
						        </td>
							</tr>
							<tr>
								<td style="text-align:left;"><strong>ORIGEN/TIPO:</strong></td>
						        <td style="text-align:left" width="70%" colspan="4">
									<input type="text" class="form-control"
										value="@mantTransacReport.getNameTipoPersonal()"
										readonly>
						        </td>
							</tr>
							<tr>
								<td style="text-align:left;"><strong>EQUIPO:</strong></td>
						        <td style="text-align:left" width="70%" colspan="4">
									<input type="text" class="form-control"
										value="@mantTransacReport.getCodigoEquipo() - @mantTransacReport.getNameEquipo()"
										readonly>
						        </td>
							</tr>
							<tr>
								<td style="text-align:left;"><strong>@mapDiccionario.get("BODEGA")/PROYECTO:</strong></td>
						        <td style="text-align:left" width="70%" colspan="4">
									<input type="text" class="form-control"
										value="@mantTransacReport.getNameBodega()"
										readonly>
						        </td>
							</tr>
							<tr>
								<td style="text-align:left;"><strong>TIPO @mapDiccionario.get("BODEGA")/PROYECTO:</strong></td>
						        <td style="text-align:left" width="70%" colspan="4">
									<input type="text" class="form-control"
										value="@mantTransacReport.getNameTipoBodega()"
										readonly>
						        </td>
							</tr>
							<tr>
								<td style="text-align:left;"><strong>ESTADO EN SITIO:</strong></td>
						        <td style="text-align:left" width="70%" colspan="4">
									<input type="text" class="form-control"
										value="@mantTransacReport.getId_mantEstadoEnObra()"
										readonly>
						        </td>
							</tr>
							<tr>
								<td style="text-align:left;"><strong>Hr_INI:</strong></td>
						        <td style="text-align:left">
									@if( ! mantTransacReport.getHoraIni().equals("00:00:00") && mantTransacReport.getHoraFin().equals("00:00:00")){
										<input type="time" class="form-control form-control-sm left" style="max-width:100px"
											value="@mantTransacReport.getHoraIni()"
											readonly>
									}else{
										<input type="time" class="form-control form-control-sm left" style="max-width:100px"
											readonly>
									}
						        </td>
								<td style="text-align:left;"><strong>Hr_TER:</strong></td>
						        <td style="text-align:left" colspan="2">
									@if( ! mantTransacReport.getHoraIni().equals("00:00:00") && mantTransacReport.getHoraFin().equals("00:00:00")){
										<input type="time" class="form-control form-control-sm left" style="max-width:100px"
											value="@mantTransacReport.getHoraFin()"
											readonly>
									}else{
										<input type="time" class="form-control form-control-sm left" style="max-width:100px"
											readonly>
									}
						        </td>
							</tr>
							
							<tr>
								<td style="text-align:left;"><strong><div id="lectIni_oper">Lect_INI:</div></strong></td>
						        <td style="text-align:left">
									<input type="text" class="form-control form-control-sm left" style="max-width:200px"
										value="@utilities.DecimalFormato.formato(mantTransacReport.getLectAnterior(),2)"
										readonly>
						        </td>
								<td style="text-align:left;"><strong><div id="lectTer_oper">Lect_TER:</div></strong></td>
						        <td style="text-align:left" colspan="2">
									<input type="text" class="form-control form-control-sm left" style="max-width:200px"
										value="@utilities.DecimalFormato.formato(mantTransacReport.getLectActual(),2)"
										readonly>
						        </td>
							</tr>
							
							<tr>
								<td style="text-align:left;"><strong><div id="cant_oper">CANT:</div></strong></td>
						        <td style="text-align:left" width="70%" colspan="4">
									<input type="text" class="form-control form-control-sm left" style="max-width:200px"
										value="@mantTransacReport.getLectDif()"
										readonly>
						        </td>
							</tr>
							<tr>
								<td style="text-align:left;"><strong>COMENTARIOS:</strong></td>
						        <td style="text-align:left" width="70%" colspan="4">
									<textarea class="form-control form-control-sm" rows="1" 
										readonly>@mantTransacReport.getComentario()</textarea>
						        </td>
							</tr>
							<tr>
								<td style="text-align:left;"><strong>OBSERVACIONES:</strong></td>
						        <td style="text-align:left" width="70%" colspan="4">
									<textarea class="form-control form-control-sm" rows="2" 
										readonly>@mantTransacReport.getObservaciones()</textarea>
						        </td>
							</tr>
							<tr>
								<td style="text-align:left;"  colspan="4">
									<input type="hidden" name="firmaPDFoperador" id="firma" value="0">
									FIRMA OPERADOR:<br>
									<div class="wrapper" align="center">
									<canvas id="signature-pad" class="signature-pad" width=350 height=90 style="border:1px solid #000000;" ></canvas>
									</div>
									<button type="button" class="btn btn-sm btn-warning" style="font-size: 10px;" onclick="signaturePad.clear()">Borrar firma</button>
								</td>
							</tr>
							<tr>
								<td style="text-align:left;"   colspan="5">
									FIRMA AUTORIZADA:<br>
									<div class="wrapper" align="center">
										<img src="data:image/jpeg;base64, @mantTransacReport.getFirmaPDFautorizador()" height="60px" />
									</div>
								</td>
							</tr>	
						
							<tr>
								<td colspan="5" style="text-align:center;">
									<button type="button" class="btn btn-sm btn-success" style="font-size: 10px;"onclick="grabar();" >GRABAR</button>
									&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
									<button type="button" class="btn btn-sm btn-warning" style="font-size: 10px;" onclick="location.href = '/routes3/mantWebListarReports1Get/@desdeAAMMDD,@hastaAAMMDD,@id_equipo'">CANCELAR</button>
								</td>
							</tr>
						</thead>
					</table>
					
				</form>
			</div>
		</div>
		
		<form class="formulario" id="formDescargaDocumento" method="post" action="/downloadPDF/">	
			<input type="hidden" id="descargaDocumento" name="nombreArchivo">
		</form>
		
	</div>
}

<!-- CONFIGURA PAD -->

<script src="@routes.Assets.versioned("javascripts/signature_pad.min.js")"></script>
	<script>
		let signaturePad = new SignaturePad(document.getElementById('signature-pad'), {
		  backgroundColor: 'rgba(255, 255, 255, 0)',
		  penColor: 'rgb(0, 0, 0)'
		});
	</script>
	
	<style>
		.wrapper {
		  position: relative;
		  width: 350px;
		  height: 90px;
		  -moz-user-select: none;
		  -webkit-user-select: none;
		  -ms-user-select: none;
		  user-select: none;
		}

		.signature-pad {
		  position: absolute;
		  left: 0;
		  top: 0;
		  width:350px;
		  height:90px;
		}
	</style>
<!-- FIN PAD -->

	
<script>
	$(document).ready(function() {
 		document.getElementById('mostrarmostrar').style.display="block";
	} );
	const descargaDocumento = (nombreDOC) => {
		  $('#descargaDocumento').val(nombreDOC);
		  document.getElementById('formDescargaDocumento').submit();
	}
	function grabar(){
			let data = signaturePad.toDataURL('image/png');
			let encodedImage = data.split(",");
			$("#firma").val(encodedImage[1]);
			$("#grabarFirmaOperador").submit();
	}
	window.onload = function () {
	    var canvas = document.getElementById('signature-pad');
	    var ctx = canvas.getContext('2d');
	    var img = new Image();
	    img.onload = function () {
	        ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
	    };
	    img.src = "data:image/png;base64,@mantTransacReport.getFirmaPDFoperador()";
	};

</script>
	

