@import models.utilities.Fechas
@(mapDiccionario: Map[String,String], mapPermiso: Map[String,String], userMnu: utilities.UserMnu,
equipo: tables.Equipo, atribEquipo: List[List[String]], listaTransac: List[qr.QrTransacEquipo])

    	
@main("") {

@menues(mapDiccionario, mapPermiso, userMnu, " ")
	<div id="mostrarmostrar" style="display:none;">
		@barraTitulo(mapDiccionario,equipo.codigo.toUpperCase()+" -- "+equipo.nombre.toUpperCase(),"REVISAR DATOS DE EQUIPO -- CODIFICACION QR")
		<div class="row  justify-content-md-center">
			<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
				<table class="table table-sm table-hover table-bordered table-condensed table-fluid">
					<tr>
						<td width="49%" style="vertical-align:top">
							<table id="tablaAtribEquipo" class="table table-sm table-hover table-bordered table-condensed table-fluid">
								<thead style="background-color: #eeeeee">
									<TR>
										<th colspan="3">ATRIBUTOS ASOCIADOS AL EQUIPO</th>
									</TR>
									<TR>
										<th>ATRIBUTO</th>
										<th>VALOR</th>
										<th>PUBLICAR</th>
									</TR>
								</thead>
								<tbody>
								
									<tr>
										<td style="text-align: left;">Peso (KG)</td>
										<td style="text-align: left;">@equipo.getKg()</td>
										<td style="text-align: left;"></td>
									</tr>
									<tr>
										<td style="text-align: left;">Area (M2)</td>
										<td style="text-align: left;">@equipo.getM2()</td>
										<td style="text-align: left;"></td>
									</tr>

									
									@for(lista <- atribEquipo){
										<TR>
											<td style="text-align: left;">@lista.get(0)</td>
											<td style="text-align: left;">@lista.get(1)</td>
									        <td style="text-align:center">
												<div id="cambiarEstadoPubEquipo_@lista.get(2)_@lista.get(3)">
													@if(lista.get(4).equals("1")){
														<a href="#" onclick= "qrCambiarPubEquipo('@lista.get(2)','@lista.get(3)','@lista.get(4)')">
															<kbd style="background-color: green">SI</kbd>
														</a>
										        	}
										        	@if(lista.get(4).equals("0")){
														<a href="#" onclick= "qrCambiarPubEquipo('@lista.get(2)','@lista.get(3)','@lista.get(4)')">
															<kbd style="background-color: red">NO</kbd>
														</a>
										        	}
												</div>
								        	</td>
										</TR>
									}
								</tbody>
							</table>
						</td>
						<td width="5px"></td>
						<td width="49%"  style="vertical-align:top">
							<table id="tablaAtribQr" class="table table-sm table-hover table-bordered table-condensed table-fluid">
								<thead style="background-color: #eeeeee">
									<TR>
										<th colspan="4">ATRIBUTOS ASOCIADOS AL QR</th>
									</TR>
									<TR>
										<th colspan="4">
											<form method="post" action="/qrEditEquipo/">
												<input type="hidden" name="id_equipo" value="@equipo.id">
											<button type="submit" class="btn btn-success btn-mini">Administrar Atributo QR</button>
										</th>
									</TR>
									<TR>
										<th>ATRIBUTO</th>
										<th>VALOR</th>
										<th>FECHA DE<br>VENCIMIENTO</th>
										<th>PUBLICAR</th>
									</TR>
								</thead>
								<tbody>
									@for(lista <- listaTransac){
										<TR>
											<td style="text-align: left;">@lista.campo</td>
											<td style="text-align: left;">
												@if(lista.id_qrTipoContenido==1){
									        		@if(!lista.contenido.equals("0")){ @lista.contenido }
									        	}else{
									        		@if(!lista.contenido.equals("0")){
														<a href="#" onclick="verArchivo('@lista.contenido','@lista.extencion')">
															<kbd style="background-color: #73C6B6">Revisar @lista.tipo Adjunto</kbd>
														</a>
									        		}
									        	}
											</td>
											<td  style="text-align:center; min-width:80px; background-color:@lista.colorCelda">
												<div style="display:none;">@lista.fechaVencimiento</div>
												@utilities.Fechas.DDMMAA(lista.fechaVencimiento)
											</td>
									        <td style="text-align:center">
												<div id="cambiarEstadoPubQr_@lista.id_equipo _@lista.id_qrAtributoEquipo">
													@if(lista.activo == 1){
														<a href="#" onclick= "qrCambiarPubQr('@lista.id_equipo', '@lista.id_qrAtributoEquipo', '@lista.activo')">
															<kbd style="background-color: green">SI</kbd>
														</a>
										        	}
										        	@if(lista.activo == 0){
														<a href="#" onclick= "qrCambiarPubQr('@lista.id_equipo', '@lista.id_qrAtributoEquipo', '@lista.activo')">
															<kbd style="background-color: red">NO</kbd>
														</a>
										        	}
												</div>
								        	</td>
										</TR>
									}
								</tbody>
							</table>
						</td>
					</tr>
				</table>
				<div class="noprint">
					<div class="row justify-content-md-center" >
						<div class="col-xs-5 col-sm-2 col-md-2 col-lg-2">
							<input type="button"  value="VOLVER" class="btn btn-success btn-sm rounded-pill btn-block" onclick="window.history.back()">
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
	
	

		<div id="muestraPDF" class="modal" role="dialog" data-backdrop="static" data-keyboard="false" aria-hidden="true" style="display: none;">
			<div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
				<div class="modal-content">
					<div class="modal-header">
					        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
					          <span aria-hidden="true">Ã—</span>
					        </button>
					</div>
					<div class="modal-body">
						<div class='embed-responsive' style='padding-bottom:150%'>
							<div id="rutaPDF"></div>
						</div>
					</div>
				</div>
			</div>
		</div>
	
}




<script type="text/javascript">
	$(document).ready(function() {
		  document.getElementById('mostrarmostrar').style.display="block";
	});
	
	const qrCambiarPubEquipo = (id_equipo, id_atributo, publico) =>{
		  var formData = new FormData();
		  formData.append('id_equipo',id_equipo);
		  formData.append('id_atributo',id_atributo);
		  formData.append('publico',publico);
	      $.ajax({
	            url: "/qrCambiarPubEquipo/",
	            type: "POST",
	            method: "POST",
	            data: formData,
	            cache: false,
	            contentType: false,
		     	processData: false,
		     	success: function(respuesta){
		     		if(respuesta.status){
		     			if(publico==1){
		     				document.getElementById("cambiarEstadoPubEquipo_"+id_equipo+"_"+id_atributo).innerHTML =
									"<a href='#' onclick='qrCambiarPubEquipo("+id_equipo+","+id_atributo+",0)'>"+
										"<kbd style='background-color: red'>NO</kbd>"+
									"</a>";
		     			}else{
		     				document.getElementById("cambiarEstadoPubEquipo_"+id_equipo+"_"+id_atributo).innerHTML =
									"<a href='#' onclick='qrCambiarPubEquipo("+id_equipo+","+id_atributo+",1)'>"+
										"<kbd style='background-color: green'>SI</kbd>"+
									"</a>";
		     			}
		     		}
		     	}
	        });
	  }
	  
	  const qrCambiarPubQr = (id_equipo, id_qrAtributoEquipo, publico) =>{
		  var formData = new FormData();
		  formData.append('id_equipo',id_equipo);
		  formData.append('id_qrAtributoEquipo',id_qrAtributoEquipo);
		  formData.append('publico',publico);
	      $.ajax({
	            url: "/qrCambiarPubQr/",
	            type: "POST",
	            method: "POST",
	            data: formData,
	            cache: false,
	            contentType: false,
		     	processData: false,
		     	success: function(respuesta){
		     		if(respuesta.status){
		     			if(publico==1){
		     				document.getElementById("cambiarEstadoPubQr_"+id_equipo+" _"+id_qrAtributoEquipo).innerHTML = 
									"<a href='#' onclick='qrCambiarPubQr("+id_equipo+","+id_qrAtributoEquipo+",0)'>"+
										"<kbd style='background-color: red'>NO</kbd>"+
									"</a>";
		     			}else{
		     				document.getElementById("cambiarEstadoPubQr_"+id_equipo+" _"+id_qrAtributoEquipo).innerHTML = 
									"<a href='#' onclick='qrCambiarPubQr("+id_equipo+","+id_qrAtributoEquipo+",1)'>"+
										"<kbd style='background-color: green'>SI</kbd>"+
									"</a>";
		     			}
		     		}
		     	}
	        });
	  }
	  
	  const verArchivo = (archivo,extencion) => {
			document.getElementById('rutaPDF').innerHTML="<object data='/showPdf/"+archivo+"' type='application/pdf' width='100%' height='720'></object>";
			$('#muestraPDF').modal('show');
	  }



</script>


		
		
	
