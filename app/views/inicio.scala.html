@(listaPaises: List[String], mensaje: String)

@main("") {

	<!-- CSS HOME MODERNO -->
	<link rel="stylesheet"
	href='@routes.Assets.versioned("stylesheets/views/home-modern.css")'>

	<style>
			.fondo{
				background: url('/public/images/area5-fondo.jpg') no-repeat center center;
				background-size: cover;
				width: 100%;
				text-align: center;
			}
	</style>

		<!-- =======================
         HOME MODERNO (HERO)
         ======================= -->
	<div class="home-modern"  id="heroWelcome">

		<div class="hm-bg">
			<div class="hm-bg-img"
			style="background-image:url('/public/images/area5-fondo.jpg');">
			</div>
			<div class="hm-bg-overlay"></div>
		</div>

			<!-- Logo fijo (login no tiene mapDiccionario) -->
		<div class="hm-logo">
			<small>MADA</small>
			<img src="/assets/images/mada-pc.png" alt="Logo">
		</div>

		<div class="hm-center">
			<div class="hm-card">
				<span class="hm-pill">Sistema de Gestión Integral</span>

				<h1 class="hm-title">
					Bienvenido a <br>
					<span class="hm-gradient">MADA </span>
				</h1>

				<p class="hm-desc">
					Gestione sus obras, maquinaria e inventarios con la
					máxima eficiencia y claridad operativa.
				</p>
			<!-- BOTON NUEVO -->
				<div class="hm-actions">
					<button type="button" class="hm-btn-primary" onclick="mostrarLogin()">
						Iniciar sesión
					</button>
				</div>
			</div>
	</div>


	</div>

	<div id="loginPanel" class="login-screen" style="display:none;">

			<!-- =====================
       LOGIN CENTRADO
       ===================== -->
		<div class="login-center">

			<div class="container">
				<div class="row justify-content-center align-items-center login-row">

						<!-- FORM LOGIN -->
					<div class="col-xs-12 col-sm-6 col-md-5 col-lg-4">
						<div id="loginCard" class="card shadow-lg border-0 rounded-lg p-4">

							<h2 class="text-center font-weight-bold mb-4">MADA</h2>

							<form onsubmit="return validarIngreso()">
								<input type="hidden" id="gRecaptchaResponse" name="gRecaptchaResponse">

								<div class="input-group mb-3">
									<div class="input-group-prepend">
										<label class="input-group-text" style="width:120px">País</label>
									</div>
									<select class="custom-select" id="pais"
									onchange='$("#ingPais").val(this.value)'>
									@for(lista <- listaPaises){
										<option value="@lista">@lista</option>
									}
									</select>
								</div>

								<div class="input-group mb-3">
									<div class="input-group-prepend">
										<label class="input-group-text" style="width:120px">Empresa</label>
									</div>
									<input type="text" class="form-control"
									onchange='this.value=this.value.toUpperCase();$("#ingEmpresa").val(this.value)'
									placeholder="Empresa" required>
								</div>

								<div class="input-group mb-3">
									<div class="input-group-prepend">
										<label class="input-group-text" style="width:120px">Usuario</label>
									</div>
									<input type="text" class="form-control"
									onchange='this.value=this.value.toUpperCase();$("#ingUserName").val(this.value)'
									placeholder="Usuario" required>
								</div>

								<div class="input-group mb-4">
									<div class="input-group-prepend">
										<label class="input-group-text" style="width:120px">Clave</label>
									</div>
									<input type="password" class="form-control"
									onchange='$("#ingUserKey").val(this.value)'
									placeholder="Clave" required>
								</div>

								<input type="submit"
								value="INGRESAR"
								class="btn mm-btn-primary btn-block font-weight-bold">
							</form>

							<div class="text-center mt-3">
								<u><a href="#" onclick="$('#olvidoClave').modal('show');">recuperar clave</a></u>
							</div>

						</div>
					</div>

						<!-- IMAGEN DERECHA -->
					<div class="col-xs-12 col-sm-6 col-md-5 col-lg-4 text-center d-none d-sm-block">
						<img src="/assets/images/mada-pc.png" alt="MADA" class="img-fluid mt-4" style="max-width:80%;">
					</div>

				</div>
			</div>

		</div>

			<!-- =====================
       FOOTER / INFO ABAJO
       ===================== -->
		<div class="login-footer">

				<!-- FRANJA FULL WIDTH -->
			<div class="login-footer-bg">

					<!-- CONTENIDO CENTRADO -->
				<div class="container">

					<table class="table table-sm borderless table-condensed table-fluid mb-4">
							<div class="row justify-content-center mb-4">
								<div class="col-auto">
									<input type="button" value="Más Mada..." class="mm-footer-btn"
									onclick="window.open('https://inqsol.cl/servicios-mada/','_blank')">
								</div>
								<div class="col-auto">
									<input type="button" value="Tutoriales" class="mm-footer-btn"
									onclick="window.open('https://inqsol.cl/tutoriales/#mada','_blank')">
								</div>
								<div class="col-auto">
									<input type="button" value="Contacto" class="mm-footer-btn"
									onclick="window.open('https://inqsol.cl/#contacto','_blank')">
								</div>
								<div class="col-auto">
									<input type="button" value="Asesoría" class="mm-footer-btn"
									onclick="window.open('https://inqsol.cl/asesoria/?utm_source=header','_blank')">
								</div>
							</div>

							<hr>
					<h5 class="text-center mb-4">ÁREAS CLAVE DE <span>MADA</span></h5>

					<div class="row text-center">
						<div class="col-md-4 mb-4">
							<img src="/assets/images/area2-mejores-practicas.png" width="64">
							<h6 class="mt-3 font-weight-bold">Mejores Prácticas</h6>
							<p class="small">Reúne las mejores prácticas del mercado desarrolladas por expertos.</p>
						</div>
						<div class="col-md-4 mb-4">
							<img src="/assets/images/area3-innovacion.png" width="64">
							<h6 class="mt-3 font-weight-bold">Innovación</h6>
							<p class="small">Gestión y control de inventarios como unidad de negocios.</p>
						</div>
						<div class="col-md-4 mb-4">
							<img src="/assets/images/area4-prevencion.png" width="64">
							<h6 class="mt-3 font-weight-bold">Prevención</h6>
							<p class="small">Mantenciones preventivas y correctivas con análisis de costos.</p>
						</div>
					</div>

					<hr>
					<p class="font-weight-lighter mb-1">Contactos: pbarros&#64;inqsol.cl - jiprieto&#64;inqsol.cl</p>
					<p class="font-weight-lighter">Napoleon #3233, Las Condes, Santiago de Chile</p>

				</div>

			</div>

	</div>


		<!-- =======================
         MODAL RECUPERAR CLAVE
         ======================= -->
	<div id='olvidoClave' class='modal' role='dialog' data-backdrop='static' data-keyboard='false'>
		<div class='modal-dialog modal-dialog-scrollable'>
			<div class='modal-content'>
				<div class='modal-header'>
					<h5 class='modal-title'>RECUPERAR CLAVE</h5>
					<button type='button' class='close' data-dismiss='modal'>
						<span>&times;</span>
					</button>
				</div>
				<div class='modal-body'>
					<form onsubmit="return validarRecuperar()">
							<!-- contenido original intacto -->
					</form>
				</div>
			</div>
		</div>
	</div>

		<!-- =======================
         FORMULARIOS HIDDEN
         ======================= -->
	<form id="ingresar" action="/vistaPrincipal/" method="POST">
		<input type="hidden" id="ingCaptcha" name="gRecaptchaResponse">
		<input type="hidden" id="ingPais" name="pais" value="CHILE">
		<input type="hidden" id="ingEmpresa" name="empresa">
		<input type="hidden" id="ingUserName" name="userName">
		<input type="hidden" id="ingUserKey" name="userKey">
	</form>

	<form id="recuperar" action="/recuperarClave/" method="POST">
		<input type="hidden" id="recuCaptcha" name="gRecaptchaResponse">
		<input type="hidden" id="recuPais" name="pais" value="CHILE">
		<input type="hidden" id="recuEmpresa" name="empresa">
		<input type="hidden" id="recuUserName" name="userName">
		<input type="hidden" id="recueMail" name="eMail">
	</form>

}

<script type="text/javascript">
  function mostrarLogin() {
    var hero = document.getElementById('heroWelcome');
    var login = document.getElementById('loginPanel');
    var card = document.getElementById('loginCard'); // nuevo

    if (hero) hero.classList.add('is-hidden');

    if (login) {
      login.style.display = 'flex';

      // Animamos SOLO la tarjeta, no todo el panel
      if (card) {
        card.classList.remove('fade-slide-in');
        void card.offsetWidth; // reflow
        card.classList.add('fade-slide-in');
      }

      // Evita scroll suave (se siente lento)
      window.scrollTo({ top: 0, behavior: 'auto' });
    }
  }
</script>



<script src="https://www.google.com/recaptcha/enterprise.js?render=6Lcm3DUjAAAAAMEhoeru8yNe1j7XGIRV2vG2nsV9"></script>
<script>
	// function validarIngreso() {
	//   grecaptcha.enterprise.ready(async () => {
	//     const token = await grecaptcha.enterprise.execute('6Lcm3DUjAAAAAMEhoeru8yNe1j7XGIRV2vG2nsV9', {action: 'LOGIN'}).then(onSuccessIngreso, onError);
	//   });
	//   if($("#gRecaptchaResponse").val().length > 0){
	//   	return true;
	//   }else{
	//   	return false;
	//   }
	// }
	function validarIngreso() {
		grecaptcha.enterprise.ready(async () => {
			const token = await grecaptcha.enterprise.execute('6Lcm3DUjAAAAAMEhoeru8yNe1j7XGIRV2vG2nsV9', {action: 'LOGIN'});
			onSuccessIngreso(token);
		});
		return false; // evita envío inmediato
	}
	function onSuccessIngreso(action_token){

		let btnIngresar = "<button style=\"visibility: visible;\" class=\"btn btn-success rounded-pill btn-block\""+
		" type=\"button\" disabled>"+
		"<span class=\"spinner-border spinner-border-sm mr-2\"></span>Enviando datos...</button>";
		$("#ingresar1").html(btnIngresar);

			$("#ingCaptcha").val(action_token);
			$("#ingresar").submit();
	}

	function validarRecuperar() {
	  grecaptcha.enterprise.ready(async () => {
	    const token = await grecaptcha.enterprise.execute('6Lcm3DUjAAAAAMEhoeru8yNe1j7XGIRV2vG2nsV9', {action: 'LOGIN'}).then(onSuccessRecuperar, onError);
	  });
	  if($("#gRecaptchaResponse").val().length > 0){
	  	return true;
	  }else{
	  	return false;
	  }
	}
	function onSuccessRecuperar(action_token){

		let btnRecuperar = "<button style=\"visibility: visible;\" class=\"btn btn-success rounded-pill btn-block\""+
		" type=\"button\" disabled>"+
		"<span class=\"spinner-border spinner-border-sm mr-2\"></span>Enviando datos...</button>";
		$("#recuperar1").html(btnRecuperar);

			$("#recuCaptcha").val(action_token);
			$("#recuperar").submit();
	}

	function onError(reason) {
	  alert("problemas con el captcha, contactar a inqsol.cl");
      location.reload();
    }
</script>


	<script>
            $(document).ready(function() {
                if("@mensaje"!="0") alert("@mensaje");
            });
    </script>











