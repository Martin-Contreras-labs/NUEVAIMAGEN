@(mapDiccionario: Map[String,String], fecha: String, listEstaOperacional: List[tables.MantEstadoEnObra],
		operMec: tables.MantOperadorMecanico, listTipoMantencion: List[tables.TipoMantencion],
listEstadoEnTaller: List[tables.MantEstadoEnTaller], 
listActividad: List[tables.MantActividad], listTipoActividad: List[tables.MantTipoActividad], listItemIntervenido: List[tables.MantItemIntervenido],
listComponentes: List[tables.MantComponente])
<div id="enCarga" class="blocker" style="display: none;"><br><br><br><br><br><br><h1>En proceso.....<div id="msgEspera"></div></h1></div>
		<table class="table table-sm table-bordered table-condensed table-fluid">
			<thead>
				<tr>
					<td style="text-align:left;"><strong>EQUIPO (*):</strong></td>
			        <td style="text-align:left; width: 70%"  colspan="4">
			        	<input type="hidden" id="id_equipo_mecP" name="id_equipo_mecP" value="0">
			        	<div id="nombreEquipo_mecP">
			        		<div class="input-group input-group-sm">
							  <input class="form-control" type="text" 
								onclick="$('#modalListaEquipos_mec').modal('show');" 
								id="valNomEquip_mecP"
								value="--- select ---" readonly>
							  <div class="input-group-append">
							    <span class="input-group-text" onclick="$('#modalListaEquipos_mec').modal('show');">Buscar</span>
							  </div>
							</div> 
	    				</div>
			        </td>
				</tr>
				<tr>
					<td style="text-align:left;"><strong>TIPO DE PLAN:</strong></td>
			        <td style="text-align:left; width: 70%"  colspan="4">
						<input type="hidden" id="id_tipoPlan_mecP" name="id_tipoPlan_mecP" value="0">
						<input class="form-control" id="tipoPlan_mecP" type="text" value="" readonly>
			        </td>
				</tr>
				<tr>
					<td style="text-align:left;"><strong>@mapDiccionario.get("BODEGA")/PROYECTO (*):</strong></td>
			        <td style="text-align:left; width: 70%"  colspan="4">
			        	<input type="hidden" id="id_bodega_mecP" name="id_bodega_mecP" value="0">
			        	<div id="nombreBodega_mecP">
			        		<div class="input-group input-group-sm">
							  <input class="form-control" type="text" 
								onclick="$('#modalListaBodegas').modal('show');" 
								id="valNomBod_mecP"
								value="--- select ---" readonly>
							  <div class="input-group-append">
							    <span class="input-group-text" onclick="$('#modalListaBodegas').modal('show');">Buscar</span>
							  </div>
							</div> 
	    				</div>
			        </td>
				</tr>
				<tr>
					<td style="text-align:left;"><strong>TIPO @mapDiccionario.get("BODEGA")/PROYECTO:</strong></td>
			        <td style="text-align:left; width: 70%"  colspan="4">
						<input class="form-control" id="tipoBodega_mecP" type="text" value="" readonly>
			        </td>
				</tr>
				<tr>
					<td style="text-align:left;"><strong>ESTADO OPERACIONAL (*):</strong></td>
			        <td style="text-align:left; width: 70%"  colspan="4">
			        	<select class="form-control form-control-sm" 
							id="id_mantEstadoOperacionalP" 
							name="id_mantEstadoOperacionalP"
							required disabled>
				        		<option class="blank" value="0">-- Select --</option>
			            		@for(lista <- listEstaOperacional){
			                		<option value="@lista.id" >@lista.nombre</option>
								}
				        </select> 
			        </td>
				</tr>
				<tr>
					<td style="text-align:left;"><strong>ESTADO EN TALLER (*):</strong></td>
			        <td style="text-align:left; width: 70%"  colspan="4">
			        	<select class="form-control form-control-sm" 
							id="id_mantEstadoEnTallerP" 
							name="id_mantEstadoEnTallerP"
							required disabled>
				        		<option class="blank" value="0">-- Select --</option>
			            		@for(lista <- listEstadoEnTaller){
			                		<option value="@lista.id" >@lista.nombre</option>
								}
				        </select> 
			        </td>
				</tr>
				<tr>
					<td style="text-align:left;"><strong>ACTIVIDAD (*):</strong></td>
			        <td style="text-align:left; width: 70%"  colspan="4">
			        	<select class="form-control form-control-sm" 
							id="id_mantActividadP" 
							name="id_mantActividadP"
							required disabled>
				        		<option class="blank" value="0">-- Select --</option>
			            		@for(lista <- listActividad){
			                		<option value="@lista.id" >@lista.nombre</option>
								}
				        </select> 
			        </td>
				</tr>
				<tr>
					<td style="text-align:left;"><strong>TIPO DE ACTIVIDAD (*):</strong></td>
			        <td style="text-align:left; width: 70%"  colspan="4">
			        	<select class="form-control form-control-sm" 
							id="id_mantTipoActividadP" 
							name="id_mantTipoActividadP"
							required disabled>
				        		<option class="blank" value="0">-- Select --</option>
			            		@for(lista <- listTipoActividad){
			                		<option value="@lista.id" >@lista.nombre</option>
								}
				        </select> 
			        </td>
				</tr>
				<tr>
					<td style="text-align:left;"><strong>ITEM INTERVENIDO (*):</strong></td>
			        <td style="text-align:left; width: 70%"  colspan="4">
			        	<select class="form-control form-control-sm" 
							id="id_mantItemIntervenidoP" 
							name="id_mantItemIntervenidoP"
							required disabled>
				        		<option class="blank" value="0">-- Select --</option>
			            		@for(lista <- listComponentes){
			                		<option value="@lista.id" >@lista.nombre</option>
								}
				        </select> 
			        </td>
				</tr>
				<tr>
					<td style="text-align:left;"><strong>COMPONENTES:</strong></td>
			        <td style="text-align:left; width: 70%"  colspan="4">
			        	<table id="tblComponentesP" class="table table-sm table-bordered table-condensed table-fluid">
							<thead>
								<tr>
									<th style="text-align:left; vertical-align: middle; width: 70%">Componentes</th>
									<th style="text-align:left; vertical-align: middle; width: 70%">Cantidad</th>
									<th style="text-align:left; vertical-align: middle; width: 70%">DEL</th>
									<th style='display:none'>id_producto</th>
								</tr>
							</thead>
							<tbody>
								<tr>
									<td style="text-align:left;vertical-align:middle">
										<input type="hidden" class="classIdComponentesP" id="id_componenteP0" name="id_mantComponenteP[]" value="0">
										<div id="componenteP0">
											<div class="input-group input-group-sm">
											  <input class="form-control" type="text" onclick="showComponentesP();" readonly>
											  <div class="input-group-append">
											    <span class="input-group-text" onclick="showComponentesP();">Buscar</span>
											  </div>
											</div>
					    				</div>
					    			</td>
									<td>
										<div id="divCantidadP0">
											<input type='text' style='text-align:right;' class='form-control form-control-sm' 
												name='cantidadP[]' id='cantidadP0' readonly></div>
									</td>
									<td style="text-align:center;">
										<div id='delLineaP0'></div>
									</td>
									<td style='display:none' id="tdId_componenteP0">0</td>
								</tr>
							</tbody>
			        	</table>
					</td>
				</tr>
				<tr>
					<td style="text-align:left;"><strong>Fecha_INI:</strong></td>
			        <td style="text-align:left">
						<input type="date" class="form-control form-control-sm left" style="max-width:150px"
							id="fechaIni_mecP" 
							name="fechaIni_mecP"
							onblur="validarFechaIni_mecP()"
							value="@fecha">
			        </td>
					<td style="text-align:left;"><strong>Fecha_TER:</strong></td>
			        <td style="text-align:left" colspan="2">
						<input type="date" class="form-control form-control-sm left"  style="max-width:150px"
							id="fechaTer_mecP" 
							name="fechaTer_mecP"
							onblur="validarFechaTer_mecP()"
							value="@fecha">
			        </td>
				</tr>	
				<tr>
					<td style="text-align:left;"><strong>Hr_INI:</strong></td>
			        <td style="text-align:left">
						<input type="time" class="form-control form-control-sm left" style="max-width:100px"
							id="horaIni_mecP" 
							name="horaIni_mecP"
							onblur="validarHoraIni_mecP()">
			        </td>
					<td style="text-align:left;"><strong>Hr_TER:</strong></td>
			        <td style="text-align:left" colspan="2">
						<input type="time" class="form-control form-control-sm left"  style="max-width:100px"
							id="horaTer_mecP" 
							name="horaTer_mecP"
							onblur="validarHoraTer_mecP()">
			        </td>
				</tr>
				
				<tr>
					<td style="text-align:left;"><strong><div id="lectIni_mecP">Lect_INI:</div></strong></td>
			        <td style="text-align:left">
						<input type="hidden" id="idUnidadMant_mecP" name="id_unidadMantencion">
						<input type="text" class="form-control form-control-sm left" style="max-width:200px"
							id="lecturaIni_mecP" 
							name="lecturaIni_mecP"
							value = "0.00"
							onClick="this.select();"
							onfocus="value=value.replace(/,/g,'')" 
							onfocusout = "if(value.trim()=='') value=0; value = formatStandar(value, 2);"
							onkeydown="return ingresoDouble(window.event)"
							onchange="validarLectIni_mecP()"
							autocomplete="off"
							required disabled>
			        </td>
					<td style="text-align:left;"><strong><div id="lectTer_mecP">Lect_TER(*):</div></strong></td>
			        <td style="text-align:left" colspan="2">
						<input type="text" class="form-control form-control-sm left" style="max-width:200px"
							id="lecturaTer_mecP" 
							name="lecturaTer_mecP"
							value = "0.00"
							onClick="this.select();"
							onfocus="value=value.replace(/,/g,'')" 
							onfocusout = "if(value.trim()=='') value=0; value = formatStandar(value, 2);"
							onkeydown="return ingresoDouble(window.event)"
							onchange="validarLectTer_mecP()"
							autocomplete="off"
							required disabled>
			        </td>
				</tr>
				
				<tr>
					<td style="text-align:left;"><strong><div id="cant_mecP">CANT:</div></strong></td>
			        <td style="text-align:left; width: 70%"  colspan="4">
						<input type="text" class="form-control form-control-sm left"
							id="cantidad_mecP" 
							name="cantidad_mecP"
							value = "0.00"
							onClick="this.select();"
							onfocus="value=value.replace(/,/g,'')" 
							onfocusout = "if(value.trim()=='') value=0; value = formatStandar(value, 2);"
							onkeydown="return ingresoDouble(window.event)"
							onchange="if(value.trim()=='') value=formatStandar(0,2);"
							autocomplete="off"
							required disabled>
			        </td>
				</tr>
				<tr>
					<td style="text-align:left;"><strong>DESCRIPCION TRABAJO:</strong></td>
			        <td style="text-align:left; width: 70%"  colspan="4">
						<textarea class="form-control form-control-sm" rows="1" 
							id="descTrabajoP"
							name="descTrabajoP" 
							autocomplete="off"></textarea>
			        </td>
				</tr>
				<tr>
					<td style="text-align:left;"><strong>ESTADO FINAL:</strong></td>
			        <td style="text-align:left; width: 70%"  colspan="4">
						<textarea class="form-control form-control-sm" rows="1" 
							id="estadoFinalP"
							name="estadoFinalP" 
							autocomplete="off"></textarea>
			        </td>
				</tr>
				<tr>
					<td style="text-align:left;"><strong>OBSERVACIONES:</strong></td>
			        <td style="text-align:left; width: 70%"  colspan="4">
						<textarea class="form-control form-control-sm" rows="2" 
							id="observaciones_mecP"
							name="observaciones_mecP" 
							autocomplete="off"></textarea>
			        </td>
				</tr>
				
				<tr>
					<td style="text-align:left;"  colspan="5">
						FIRMA MECANICO:<br>
						<div class="wrapper" align="center">
						<canvas id="signature-pad5" class="signature-pad" width=350 height=90 style="border:1px solid #000000;"></canvas>
						</div>
						<button type="button" class="btn btn-sm btn-warning" style="font-size: 10px;" onclick="signaturePad5.clear()">Borrar firma</button>
					</td>
				</tr>
				<tr>
					<td style="text-align:left;"   colspan="5">
						FIRMA AUTORIZADA:<br>
						<div class="wrapper" align="center">
						<canvas id="signature-pad6" class="signature-pad" width=350 height=90 style="border:1px solid #000000;"></canvas>
						</div>
						<button type="button" class="btn btn-sm btn-warning" style="font-size: 10px;" onclick="signaturePad6.clear()">Borrar firma</button>
					</td>
				</tr>
			
				<tr>
					<td colspan="5" style="text-align:center;">
						<button type="button" class="btn btn-sm btn-success" style="font-size: 10px;"onclick="grabarMecanicoP();" >GRABAR REPORT
						</button>
						&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
						<button type="button" class="btn btn-sm btn-warning" style="font-size: 10px;" onclick="location.href = '/report'">SALIR</button>
					</td>
				</tr>
			</thead>
		</table>

<script>

function validarLectIni_mecP(){
		let lecturaIni = $("#lecturaIni_mecP").val().replace(/,/g,'');
		let lecturaTer = $("#lecturaTer_mecP").val().replace(/,/g,'');
		try{
			lectAnterior = lectAnterior.replace(/,/g,'');
		}catch(e){
			lectAnterior = lectAnterior;
		}
		if(parseFloat(lecturaIni) < parseFloat(lectAnterior)){
			if(parseFloat(lecturaIni) == 0 && $("#id_tipoMantencion").val() == 1){
				alertify.confirm(
	            	"Colocar la lectura inicial en cero corresponde a cambio, reset o inicio de odómetro y/u horómetro. Esta seguro de esta acción?",
		            function(e) { 
						if (e) {
							$("#lecturaTer_mecP").val("0.00");
						}else{
							$("#lecturaIni_mecP").val(formatStandar(lectAnterior,2));
						}
					}
	        	);
			}else{
				alertify.alert("La lectura inicial no puede ser menor a la ultima lectura registrada");
			$("#lecturaIni_mecP").val(formatStandar(lectAnterior,2));
			}
			
		}else if(lecturaTer!="0.00"){
			if(parseFloat(lecturaIni) > parseFloat(lecturaTer)){
				alertify.alert("La lectura inicial no puede ser menor a la lectura de termino");
				$("#lecturaIni_mecP").val(formatStandar(formatStandar(lectAnterior,2)));
			}else{
				let dif = parseFloat(lecturaTer) - parseFloat(lecturaIni);
				$("#cantidad_mecP").val(formatStandar(dif,2));
			}
		}
	}
	
	function validarLectTer_mecP(){
		let lecturaIni = $("#lecturaIni_mecP").val().replace(/,/g,'');
		let lecturaTer = $("#lecturaTer_mecP").val().replace(/,/g,'');
			if(parseFloat(lecturaIni) > parseFloat(lecturaTer)){
				alertify.alert("La lectura inicial no puede ser menor a la lectura de termino");
				$("#lecturaTer_mecP").val(formatStandar(0,2));
				$("#cantidad_mecP").val(formatStandar(0,2));
			}else{
				let dif = parseFloat(lecturaTer) - parseFloat(lecturaIni);
				$("#cantidad_mecP").val(formatStandar(dif,2));
			}
	}
	
	function validarHoraIni_mecP(){
		let horaIni = $("#horaIni_mecP").val();
		let horaTer = $("#horaTer_mecP").val();
		if(horaTer!=""){
			if(parseFloat(horaIni) >= parseFloat(horaTer)){
				alertify.alert("La hora inicial no puede ser menor o igual a la hora de termino");
				$("#horaIni_mecP").val("");
				$("#horaTer_mecP").val("");
			}
		}
	}
	
	function validarHoraTer_mecP(){
		let horaIni = $("#horaIni_mecP").val();
		let horaTer = $("#horaTer_mecP").val();
		if(horaIni==""){
			alertify.alert("Primero debe ingresar la hora inicial");
			$("#horaTer_mecP").val("");
		}else{
			if(horaIni > horaTer){
				alertify.alert("La hora inicial no puede ser menor a la hora de termino");
				$("#horaTer_mecP").val("");
			}
		}
	}
	
	
	function validarFechaIni_mecP(){
		let fechaIni = new Date($("#fechaIni_mecP").val());
		if(isValidDate(fechaIni)){
			let fechaTer = new Date($("#fechaTer_mecP").val());
			if(fechaIni > fechaTer){
				alertify.alert("La fecha de inicio no puede ser posterior a la fecha de termino.");
	        		$('#fechaIni_mecP').val('@fecha');
			}
		}else{
			alertify.alert("Debe ingresar una fecha valida.");
	        		$('#fechaIni_mecP').val('@fecha');
		}
		
	}
	
	function validarFechaTer_mecP(){
		let fechaTer = new Date($("#fechaTer_mecP").val());
		if(isValidDate(fechaTer)){
			let fechaIni = new Date($("#fechaIni_mecP").val());
			if(fechaIni > fechaTer){
				alertify.alert("La fecha de termino no puede ser anterior a la fecha de inicio.");
	        		$('#fechaTer_mecP').val('@fecha');
			}
		}else{
			alertify.alert("Debe ingresar una fecha valida.");
	        		$('#fechaTer_mecP').val('@fecha');
		}
	}
	
	function grabarMecanicoP(){
		  if($('#id_mecanico').val()==0){
			  alertify.alert('Debe seleccionar un Mecanico');
		  }else if($('#id_tipoMantencion').val()==0){
			  alertify.alert('Debe seleccionar un Tipo de Mantencion');
		  }else if($('#id_equipo_mecP').val()==0){
			  alertify.alert('Debe seleccionar un Equipo');
		  }else if($('#id_bodega_mecP').val()==0){
			  alertify.alert('Debe seleccionar una @mapDiccionario.get("Bodega")/Proyecto');
		  }else if($('#id_mantEstadoOperacionalP').val()==0){
			  alertify.alert('Debe ingresar un Estado en Operacional');
		  }else if($('#id_mantEstadoEnTallerP').val()==0){
			  alertify.alert('Debe ingresar un Estado en Taller');
		  }else if($('#id_mantActividadP').val()==0){
			  alertify.alert('Debe ingresar una Actividad');
	      }else if($('#id_mantTipoActividadP').val()==0){
			  alertify.alert('Debe ingresar un tipo de Actividad');
		  }else if($('#id_mantItemIntervenidoP').val()==0){
			  alertify.alert('Debe ingresar un Item Intervenido');
		  }else if($('#lecturaTer_mecP').val()=="0.00"){
			  alertify.alert('Debe ingresar Lect_TER que debe ser mayor a cero');
		  }else{
			let data = signaturePad5.toDataURL('image/png');
			let encodedImage = data.split(",");
			$("#firmaEjecutor").val(encodedImage[1]);

			data = signaturePad6.toDataURL('image/png');
			encodedImage = data.split(",");
			$("#firmaAprobador").val(encodedImage[1]);
			document.getElementById('enCarga').style.display="block";
			$("#grabarRptOperadorMecanico").submit();
		  }
	}
	
</script>
	