@(mapDiccionario: Map[String,String], mapPermiso: Map[String,String], userMnu: utilities.UserMnu,
fechaDesde: String, fechaHasta: String, 
sucursal: tables.Sucursal, listSucursal: List[tables.Sucursal])
    	
@main("") {

	@menues(mapDiccionario, mapPermiso, userMnu, " ")
	<div id="mostrarmostrar" style="display:none;">
		@barraTitulo(mapDiccionario, "REPORTE PIPELINE RESUMIDO","(SELECCIONAR PERIODO MOVIL)")
		<form action="/routes2/reportPipelineRptRes/" method="POST" onsubmit="return validarForm();">
			<br><br><br>
			<div class="row  justify-content-md-center">
				<div class="col-xs-6 col-sm-3 col-md-3 col-lg-3">
					<table class="table table-sm table-bordered table-condensed table-fluid">
						<thead style="background-color: #eeeeee">
							<TR>
								<TH colspan="2">PERIODO DE COTIZACIONES A CONSIDERAR</TH>
							</TR>
							<TR>
								<TH>FECHA DESDE:</TH>
								<td>
									<input type="date" class="form-control center"
										id="fechaDesde"
							  			name="fechaDesde"
							  			value="@fechaDesde"
					        			required>
								</td>
							</TR>
							<TR>
								<TH>FECHA HASTA:</TH>
								<td>
									<input type="date" class="form-control center"
										id="fechaHasta"
							  			name="fechaHasta"
							  			value="@fechaHasta"
					        			required>
								</td>
							</TR>
							<TR>
								<TH>SUCURSAL:</TH>
								<td>
									<input type="hidden" id="id_sucursal" name="id_sucursal" value="0">
										@if(mapPermiso.get("cambiarSucursal")!=null){
											@if(mapPermiso.get("cambiarComercial")!=null){
												<select id="selSucursal" class="custom-select center"  onchange = "$('#id_sucursal').val(value); actualizaComerciales(value); ">
													<option value="0">-- TODAS --</option>
													@for(lista <- listSucursal){
														<option value="@lista.getId()">@lista.getNombre()</option>
													}
												</select>
											}else{
												<select id="selSucursal" class="custom-select center"  onchange = "$('#id_sucursal').val(value); ">
													<option value="0">-- TODAS --</option>
													@for(lista <- listSucursal){
														<option value="@lista.getId()">@lista.getNombre()</option>
													}
												</select>
											}
										}else{
											<input id="selSucursal" type="text" class="form-control left"
												value = "@sucursal.getNombre()"
												readonly>
										}
								</td>
							</TR>
							
							<TR style="background-color: rgb(254, 255, 255)">
								<TH colspan="2"><br>
							</TR>
						</thead>
						<tbody>
						</tbody>
					</table>
				</div>
			</div>
			<div class="row  justify-content-md-center">
				<div class="col-xs-4 col-sm-2 col-md-2 col-lg-2">
					<input type="submit" id="btnSubmit" value='Generar Reporte' class="btn btn-primary btn-sm rounded-pill btn-block">
				</div>
			</div>
		</form>
	</div>

}


<script type="text/javascript">
	$(document).ready(function() {
		  document.getElementById('mostrarmostrar').style.display="block";
	});
	
	const validarForm = () =>{
		$("#btnSubmit").attr('disabled',true);
		let flag = true;
		var desde = document.getElementById('fechaDesde').value;
		var hasta = document.getElementById('fechaHasta').value;
		if(desde > hasta){
			flag = false;
			alertify.alert('LA FECHA INICIAL NO PUEDE SER MAYOR A LA FECHA FINAL', function () {
				$("#btnSubmit").attr('disabled',false);
				return(flag);
     		});
		}
		return(flag);
	}
	
	const actualizaComerciales = (id_sucursal) =>{
		var formData = new FormData();
		formData.append('id_sucursal',id_sucursal);
        $.ajax({
            url: "/actualizaComerciales2Ajax/",
            type: "POST",
            method: "POST",
            data: formData,
            cache: false,
            contentType: false,
	     	processData: false,
	     	success: function(respuesta){
				document.getElementById('actualComerciales').innerHTML = respuesta;
				$("#formSucursal").val(id_sucursal);
	     	}
        });	
	}
	
	
	
</script>




		
		
	
