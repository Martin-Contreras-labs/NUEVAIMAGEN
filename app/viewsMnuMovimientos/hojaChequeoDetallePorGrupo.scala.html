@(mapDiccionario: Map[String,String], mapPermiso: Map[String,String], userMnu: utilities.UserMnu,
bodegaOrigen: tables.BodegaEmpresa, listEquipBodOrigen: List[List[String]], listTipoEstado: List[tables.TipoEstado], idGrupos: List[Long],
contactos: String, direccion: String)
    			
    	
@main("") {

	@menues(mapDiccionario, mapPermiso, userMnu, " ")
	
	@modalEquipoDescripcion()
	
	<div id="mostrarmostrar" style="display:none;">
		@barraTitulo(mapDiccionario, "HOJA DE CHEQUEO POR GRUPOS SELECCIONADOS","(agrupado por equipo)")
		<div class="row  justify-content-md-center">
			<div class="col-xs-5 col-sm-2 col-md-2 col-lg-2">
				<div class="noprint">
					<input type="button" class="btn btn-primary btn-sm rounded-pill btn-block" onclick="window.print(); return false;" value="Imprimir">
				</div>
				<br>
			</div>
			<div class="col-xs-5 col-sm-2 col-md-2 col-lg-2">
				<div class="noprint">
					<form action="/hojaChequeoDetallePorGrupoExcel/" method="POST" onsubmit="return validarForm();">
						<input type="hidden" name="id_bodegaEmpresa" value="@bodegaOrigen.getId()">
						@for(lista <- idGrupos){
							<input type="hidden" name="idGrupos[]" value="@lista">
						}
						<input type="submit" id="btnSubmit" class="btn btn-info btn-sm rounded-pill btn-block" value="Excel">
					</form>
				</div>
				<br>
			</div>
			
			
			
			<div class="col-xs-12 col-sm-11 col-md-11 col-lg-11">
				<table class="table table-sm table-hover table-bordered table-condensed table-fluid">
					<TR>
						<th colspan="2" style="text-align: center;">AVISO</th>
						<th colspan="2" style="text-align: center;">RECEPCION</th>
						<th colspan="2" style="text-align: center;">CHEQUEO</th>
					</TR>
					<TR>
						<th colspan="1" style="text-align: center;">FECHA</th>
						<th colspan="1" style="text-align: center;">HORA</th>
						<th colspan="1" style="text-align: center;">FECHA</th>
						<th colspan="1" style="text-align: center;">HORA</th>
						<th colspan="1" style="text-align: center;">FECHA</th>
						<th colspan="1" style="text-align: center;">HORA</th>
					</TR>
					<TR>
						<td colspan="1" style="text-align: center;width:16%"><BR></td>
						<td colspan="1" style="text-align: center;width:17%"><BR></td>
						<td colspan="1" style="text-align: center;width:16%"><BR></td>
						<td colspan="1" style="text-align: center;width:17%"><BR></td>
						<td colspan="1" style="text-align: center;width:16%"><BR></td>
						<td colspan="1" style="text-align: center;width:18%"><BR></td>
					</TR>
					<TR>
						<th colspan="6" style="text-align: center;"></th>
					</TR>
					<TR>
						<th colspan="1" style="text-align: left;">CLIENTE:</th>
						<td colspan="2" style="text-align: left;">@bodegaOrigen.getNickCliente()</td>
						<th colspan="1" style="text-align: left;"></th>
						<td colspan="2" style="text-align: left;"></td>
					</TR>
					<TR>
						<th colspan="1" style="text-align: left;">@mapDiccionario.get("BODEGA") (PROYECTO):</th>
						<td colspan="2" style="text-align: left;">@bodegaOrigen.getNombre().toUpperCase() (@bodegaOrigen.getNickProyecto())</td>
						<th colspan="1" style="text-align: left;">DIRECCION PROYECTO:</th>
						<td colspan="2" style="text-align: left;">@direccion</td>
					</TR>
					<TR>
						<th colspan="1" style="text-align: left;">TRANSPORTE:</th>
						<td colspan="2" style="text-align: left;"></td>
						<th colspan="1" style="text-align: left;">FONO CONTACTO TRANSPORTE:</th>
						<td colspan="2" style="text-align: left;"></td>
					</TR>
					<TR>
						<th colspan="6" style="text-align: left;">CONTACTOS @mapDiccionario.get("BODEGA"): @contactos</th>
					</TR>
					<TR style="vertical-align: middle;">
						<th colspan="6" style="text-align: left;">MATERIAL PARA RECOGER</th>
					</TR>
				</table>
				<hr>
				<table id="tablaPrincipal" class="table table-sm table-hover table-bordered table-condensed table-fluid">
					<thead style="background-color: #eeeeee">
						<TR>
							<TH>GRUPO</TH>
							<TH>CODIGO</TH>
							<TH>EQUIPO</TH>
							<TH>KG</TH>
					        <TH>M2</TH>
					        <TH>UN</TH>
							<TH>CANTIDAD</TH>
							@if(bodegaOrigen.esInterna!=1){
								@for(titEstado <- listTipoEstado){
									<TH style="font-size:10px; vertical-align:middle">
										@titEstado.getSigla()
									</TH>
								}
							}
						</TR>
					</thead>
					<tbody>
						@for(lista1 <- listEquipBodOrigen){
							<TR>
								<td  style="text-align:left;">@lista1.get(1)</td>
								<td  style="text-align:left;"><a href="#" onclick="buscaEquipo('@lista1.get(2)');">@lista1.get(2)</a></td>
								<td  style="text-align:left;"><a href="#" onclick="buscaEquipo('@lista1.get(2)');">@lista1.get(3)</a></td>

								<td  class="kg"  style="text-align:right;">@lista1.get(4)</td>
								<td  class="m2"  style="text-align:right;">@lista1.get(5)</td>
								<td  style="text-align:center;">@lista1.get(6)</td>
								@if(mapPermiso.get("parametro.ocultar-cant-hoja-chequeo")!=null && mapPermiso.get("parametro.ocultar-cant-hoja-chequeo").equals("1")){
									<td class="cant"  style="text-align:right;"></td>
								}else{
									<td class="cant"  style="text-align:right;">@lista1.get(7)</td>
								}
								@if(bodegaOrigen.esInterna!=1){
									@for((est,index) <- listTipoEstado.zipWithIndex){
										<td></td>
									}
								}
							</TR>
			 			}
					</tbody>
					<tfoot>
						<TR>
							<TH>TOTALES</TH>
							<TH></TH>
							<TH></TH>
							<TH id="totKg" style="text-align:right;"></TH>
					        <TH id="totM2" style="text-align:right;"></TH>
					        <TH></TH>
							<TH id="totCant" style="text-align:right;"></TH>
							@if(bodegaOrigen.esInterna!=1){
								@for(titEstado <- listTipoEstado){
									<TH style="font-size:10px; vertical-align:middle">
										
									</TH>
								}
							}
						</TR>
					</tfoot>
				</table>
			</div>
		</div>
		<div class="noprint" align="left">
			<div class="row justify-content-md-center" >
				<div class="col-xs-5 col-sm-2 col-md-2 col-lg-2">
					<input type="button"  value="LISTO" class="btn btn-success btn-sm rounded-pill btn-block" onclick="location.href='/hojaChequeoSelectBodegaAgrupado/';">
				</div>
			</div>
		</div>
	</div>
}


<style>
	#tablaPrincipal td:nth-child(2) { text-align: center; }
	#tablaPrincipal td:nth-child(3) { text-align: center; }
	#tablaPrincipal td:nth-child(5) { text-align: right; }
	#tablaPrincipal td:nth-child(6) { text-align: right; }
	#tablaPrincipal td:nth-child(7) { text-align: center; }
	#tablaPrincipal td:nth-child(8) { text-align: right; }
	#tablaPrincipal td:nth-child(9) { text-align: right; }
	#tablaPrincipal td:nth-child(10) { text-align: center; }
	#tablaPrincipal td:nth-child(11) { text-align: center; }
	#tablaPrincipal td:nth-child(12) { text-align: right; }
	#tablaPrincipal td:nth-child(13) { text-align: right; }
	#tablaPrincipal td:nth-child(14) { text-align: right; }
	@if(bodegaOrigen.esInterna!=1){
		@for((est,index) <- listTipoEstado.zipWithIndex){
			#tablaPrincipal td:nth-child(@(index+16)) { vertical-align: middle; }
		}
	}
</style>

<script type="text/javascript">
	$(document).ready(function() {
		$('#tablaPrincipal').DataTable({
	    	"fixedHeader": true,
	    	"lengthMenu": [[-1, 20, 50, 100, 200], ["All", 20, 50, 100, 200]],
	    	"order": [[ 0, "asc" ],[ 2, "asc" ]],
	    	"language": {
	        	"url": "//cdn.datatables.net/plug-ins/9dcbecd42ad/i18n/Spanish.json"
	        }
	  	} );


		const kgs = document.querySelectorAll('td.kg');
		const m2s = document.querySelectorAll('td.m2');
		const cants = document.querySelectorAll('td.cant');
		let totKg = 0;
		let totM2 = 0;
		let totCant = 0;
		for (let i = 0; i < kgs.length; i++) {
		  const kg = kgs[i].textContent.replace(/,/g,'');
		  const m2 = m2s[i].textContent.replace(/,/g,'');
		  const cant = cants[i].textContent.replace(/,/g,''); 
		  totKg += parseFloat(kg);
		  totM2 += parseFloat(m2);
		  totCant += parseFloat(cant);
		}
		$("#totKg").text(formatStandar(totKg));
		$("#totM2").text(formatStandar(totM2));
		$("#totCant").text(formatStandar(totCant,2));
	
	
		document.getElementById('mostrarmostrar').style.display="block";
	});
	
	const validarForm = () =>{
		$("#btnSubmit").attr('disabled',true);
		return(true);
	}
	
</script>


		
		
	
