@import models.utilities.Fechas
@(mapDiccionario: Map[String,String], mapPermiso: Map[String,String], userMnu: utilities.UserMnu,
listaTransac: List[List[String]])

    	
@main("") {

@menues(mapDiccionario, mapPermiso, userMnu, " ")
	<div id="mostrarmostrar" style="display:none;">
		@barraTitulo(mapDiccionario,"REVISAR ATRIBUTOS QR","DE TODOS LOS EQUIPOS VIGENTES")
		<div class="row  justify-content-md-center">
			<div class="col-xs-5 col-sm-2 col-md-2 col-lg-2">
				<div class="noprint">
					<input type="button" class="btn btn-primary btn-sm rounded-pill btn-block" onclick="window.print(); return false;" value="Imprimir">
				</div>
				<br>
			</div>
			<div class="col-xs-5 col-sm-2 col-md-2 col-lg-2">
				<div class="noprint">
					<form action="/qrRevisarDatosAllVigentesExcel/" method="POST">
						<input type="submit" class="btn btn-info btn-sm rounded-pill btn-block" value="Exportar a Excel">
					</form>
				</div>
				<br>
			</div>
			<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
				<table id="tablaAtribQr" class="table table-sm table-hover table-bordered table-condensed table-fluid">
					<thead style="background-color: #eeeeee">
						<TR>
							<th colspan="10">ATRIBUTOS ASOCIADOS AL QR</th>
						</TR>
						<TR>
							<th>CODIGO</th>
							<th>EQUIPO</th>
							<th>ATRIBUTO</th>
							<th>VALOR</th>
							<th>FECHA DE<br>VENCIMIENTO</th>
							<th>PUBLICAR</th>
						</TR>
					</thead>
					<tbody>
						@for(lista <- listaTransac){
							<TR>
								<td style="text-align: left;">@lista.get(0)</td>
								<td style="text-align: left;">@lista.get(1)</td>
								<td style="text-align: left;">@lista.get(2)</td>
								<td style="text-align: left;">
									@if(lista.get(3).equals("1")){
										@if(!lista.get(4).equals("0")){ @lista.get(4) }
									}else{
										@if(!lista.get(4).equals("0")){
											<a href="#" onclick="verArchivo('@lista.get(4)','@lista.get(5)')">
												<kbd style="background-color: #73C6B6">Revisar @lista.get(6) Adjunto</kbd>
											</a>
										}
									}
								</td>
								<td  style="text-align:center; min-width:80px; background-color:@lista.get(7)">
									<div style="display:none;">@lista.get(8)</div>
									@utilities.Fechas.DDMMAA(lista.get(8))
								</td>
								<td style="text-align:center">
									<div id="cambiarEstadoPubQr_@lista.get(9) _@lista.get(10)">
										@if(lista.get(11).equals("1")){
											<a href="#" onclick= "qrCambiarPubQr('@lista.get(9)', '@lista.get(10)', '@lista.get(11)')">
												<kbd style="background-color: green">SI</kbd>
											</a>
										}
										@if(lista.get(11).equals("0")){
											<a href="#" onclick= "qrCambiarPubQr('@lista.get(9)', '@lista.get(10)', '@lista.get(11)')">
												<kbd style="background-color: red">NO</kbd>
											</a>
										}
									</div>
								</td>
							</TR>
						}
					</tbody>
				</table>
				<div class="noprint">
					<div class="row justify-content-md-center" >
						<div class="col-xs-5 col-sm-2 col-md-2 col-lg-2">
							<input type="button"  value="VOLVER" class="btn btn-success btn-sm rounded-pill btn-block" onclick="window.history.back()">
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
	
	

		<div id="muestraPDF" class="modal" role="dialog" data-backdrop="static" data-keyboard="false" aria-hidden="true" style="display: none;">
			<div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
				<div class="modal-content">
					<div class="modal-header">
					        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
					          <span aria-hidden="true">Ã—</span>
					        </button>
					</div>
					<div class="modal-body">
						<div class='embed-responsive' style='padding-bottom:150%'>
							<div id="rutaPDF"></div>
						</div>
					</div>
				</div>
			</div>
		</div>
	
}




<script type="text/javascript">
	$(document).ready(function() {

		$('#tablaAtribQr').DataTable({
			"fixedHeader": true,
			"paging": false,
			"info": false,
			"searching": true,
			"order": [],
			"language": {
				"url": "https://cdn.datatables.net/plug-ins/1.13.7/i18n/es-ES.json"
			}
		} );
		  document.getElementById('mostrarmostrar').style.display="block";
	});
	
	const qrCambiarPubEquipo = (id_equipo, id_atributo, publico) =>{
		  var formData = new FormData();
		  formData.append('id_equipo',id_equipo);
		  formData.append('id_atributo',id_atributo);
		  formData.append('publico',publico);
	      $.ajax({
	            url: "/qrCambiarPubEquipo/",
	            type: "POST",
	            method: "POST",
	            data: formData,
	            cache: false,
	            contentType: false,
		     	processData: false,
		     	success: function(respuesta){
		     		if(respuesta.status){
		     			if(publico==1){
		     				document.getElementById("cambiarEstadoPubEquipo_"+id_equipo+"_"+id_atributo).innerHTML =
									"<a href='#' onclick='qrCambiarPubEquipo("+id_equipo+","+id_atributo+",0)'>"+
										"<kbd style='background-color: red'>NO</kbd>"+
									"</a>";
		     			}else{
		     				document.getElementById("cambiarEstadoPubEquipo_"+id_equipo+"_"+id_atributo).innerHTML =
									"<a href='#' onclick='qrCambiarPubEquipo("+id_equipo+","+id_atributo+",1)'>"+
										"<kbd style='background-color: green'>SI</kbd>"+
									"</a>";
		     			}
		     		}
		     	}
	        });
	  }
	  
	  const qrCambiarPubQr = (id_equipo, id_qrAtributoEquipo, publico) =>{
		  var formData = new FormData();
		  formData.append('id_equipo',id_equipo);
		  formData.append('id_qrAtributoEquipo',id_qrAtributoEquipo);
		  formData.append('publico',publico);
	      $.ajax({
	            url: "/qrCambiarPubQr/",
	            type: "POST",
	            method: "POST",
	            data: formData,
	            cache: false,
	            contentType: false,
		     	processData: false,
		     	success: function(respuesta){
		     		if(respuesta.status){
		     			if(publico==1){
		     				document.getElementById("cambiarEstadoPubQr_"+id_equipo+" _"+id_qrAtributoEquipo).innerHTML = 
									"<a href='#' onclick='qrCambiarPubQr("+id_equipo+","+id_qrAtributoEquipo+",0)'>"+
										"<kbd style='background-color: red'>NO</kbd>"+
									"</a>";
		     			}else{
		     				document.getElementById("cambiarEstadoPubQr_"+id_equipo+" _"+id_qrAtributoEquipo).innerHTML = 
									"<a href='#' onclick='qrCambiarPubQr("+id_equipo+","+id_qrAtributoEquipo+",1)'>"+
										"<kbd style='background-color: green'>SI</kbd>"+
									"</a>";
		     			}
		     		}
		     	}
	        });
	  }
	  
	  const verArchivo = (archivo,extencion) => {
			document.getElementById('rutaPDF').innerHTML="<object data='/showPdf/"+archivo+"' type='application/pdf' width='100%' height='720'></object>";
			$('#muestraPDF').modal('show');
	  }



</script>


		
		
	
